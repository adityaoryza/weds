function handleBodyClick(e){const t=document.createElement("div");t.classList.add("magic-dust");const n=["‚ú®","‚òÖ","‚ãÜ","‚úß","üå∏"];t.innerText=n[Math.floor(Math.random()*n.length)],t.style.left=`${e.pageX}px`,t.style.top=`${e.pageY}px`;const a=["#FFD1DC","#FFB7B2","#E6E6FA","#FFD700","#FFFFFF"];t.style.color=a[Math.floor(Math.random()*a.length)],document.body.appendChild(t),setTimeout(()=>t.remove(),1e3)}function initParticles(){const e=document.getElementById("particles-container");if(!e)return;const t=window.innerWidth<768?15:30;for(let n=0;n<t;n++)createParticle(e)}function createParticle(e){const t=document.createElement("div");t.classList.add("particle");const n=6*Math.random()+2;t.style.width=`${n}px`,t.style.height=`${n}px`,t.style.left=100*Math.random()+"vw",t.style.top=100*Math.random()+"vh",t.style.opacity=.5*Math.random()+.1,t.style.background=Math.random()>.5?"var(--particle-1)":"var(--particle-2)";const a=20*Math.random()+10;t.style.animation=`drift-right ${a}s linear infinite`,t.style.animationDelay=`-${20*Math.random()}s`,e.appendChild(t)}function toggleMobileMenu(){const e=document.getElementById("mobile-menu"),t="translateY(0%)"===e.style.transform;e.style.transform=t?"translateY(-100%)":"translateY(0%)"}function toggleTheme(){document.body.classList.toggle("day-mode"),document.body.classList.toggle("night-mode"),document.documentElement.classList.toggle("dark");const e=document.body.classList.contains("night-mode")?"bedtime":"wb_sunny";document.getElementById("theme-icon-desk").innerText=e,document.getElementById("theme-icon-mobile").innerText=e,playChime()}document.addEventListener("mousemove",e=>{Math.random()>.85&&handleBodyClick(e)});let unicornsFound=0;const totalUnicorns=5;function foundUnicorn(e,t){if(t&&t.stopPropagation(),e.classList.contains("found"))return;unicornsFound++,e.classList.add("found");const n=document.getElementById("score-text");n.innerText=`${unicornsFound}/5`,n.classList.add("scale-125","text-pink-500"),setTimeout(()=>n.classList.remove("scale-125","text-pink-500"),200);document.getElementById("game-ui").classList.remove("translate-x-40"),playChime("high"),createConfetti(e.getBoundingClientRect().left,e.getBoundingClientRect().top),5===unicornsFound&&setTimeout(triggerGrandFinale,800)}function triggerGrandFinale(){const e=document.getElementById("finale-container"),t=document.getElementById("finale-message"),n=document.getElementById("game-ui");n&&(n.style.transition="opacity 1s ease-out, transform 1s ease-out",n.style.opacity="0",n.style.transform="scale(0) translateX(100%)"),e.classList.remove("hidden");const a=document.getElementById("finale-overlay");a&&a.classList.remove("opacity-0"),setTimeout(()=>t.classList.remove("scale-0"),100);let s=setInterval(()=>{const t=document.createElement("div");t.className="lantern",t.style.left=100*Math.random()+"%",t.style.bottom="-100px",t.style.transform=`scale(${.5+Math.random()})`;const n=5+5*Math.random();t.style.animation=`floatUp ${n}s linear forwards`,e.appendChild(t),setTimeout(()=>t.remove(),1e3*n)},100),o=setInterval(()=>{createConfetti(Math.random()*window.innerWidth,-10,5)},200);playChime("high"),setTimeout(()=>playChime("high"),500),setTimeout(()=>{clearInterval(s),clearInterval(o)},3e3),setTimeout(()=>{t.classList.add("scale-0"),a&&a.classList.add("opacity-0")},6e3),setTimeout(()=>{e.classList.add("hidden"),e.innerHTML='<div class="absolute inset-0 bg-black/40 transition-opacity duration-1000" id="finale-overlay"></div><div class="absolute inset-0 flex items-center justify-center"><div class="text-center transform scale-0 transition-transform duration-1000" id="finale-message"></div></div>'},14e3)}function createConfetti(e,t,n=12){for(let a=0;a<n;a++){const n=document.createElement("div");n.style.cssText=`position:fixed;left:${e}px;top:${t}px;width:8px;height:8px;background:hsl(${360*Math.random()},100%,70%);border-radius:50%;z-index:9999;pointer-events:none`,document.body.appendChild(n);const a=Math.random()*Math.PI*2,s=150*Math.random()+50;n.animate([{transform:"translate(0,0) scale(1)",opacity:1},{transform:`translate(${Math.cos(a)*s}px, ${Math.sin(a)*s}px) scale(0)`,opacity:0}],{duration:1e3,easing:"cubic-bezier(0, .9, .57, 1)"}).onfinish=()=>n.remove()}}function releaseLantern(){const e=document.getElementById("wish-input"),t=document.createElement("div"),n=""!==e.value.trim()?e.value:"‚ú®";e.value="",t.className="lantern text-[8px] text-white font-bold flex items-center justify-center",t.innerText=n.length>5?"‚ú®":n,t.style.left=80*Math.random()+10+"%",document.body.appendChild(t),createConfetti(window.innerWidth/2,window.innerHeight-50,5),setTimeout(()=>t.remove(),15e3),playChime()}let bgMusic=new Audio("assets/music/Nadin.mp3");async function toggleMusic(){const e=document.getElementById("audio-btn"),t=document.getElementById("music-icon");if(bgMusic.paused)try{await bgMusic.play(),t&&t.classList.add("animate-spin-slow"),e&&e.classList.add("music-playing")}catch(e){console.log("Audio play failed (user interaction needed):",e)}else bgMusic.pause(),t&&t.classList.remove("animate-spin-slow"),e&&e.classList.remove("music-playing")}async function playChime(e){if("running"!==Tone.context.state)return;const t=(new Tone.Synth).toDestination();t.volume.value=-8,t.triggerAttackRelease("high"===e?"C6":"E5","8n")}function typeWriter(e,t,n){n<t.length&&(e.innerHTML+=t.charAt(n),setTimeout(()=>typeWriter(e,t,n+1),20))}bgMusic.loop=!0,bgMusic.volume=.5,window.addEventListener("load",()=>{const e=document.getElementById("preloader");e&&setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{e.remove()},700)},1e3)}),document.addEventListener("DOMContentLoaded",()=>{initParticles(),renderGuestBook();const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?e.target.classList.add("active"):e.target.classList.remove("active")})},{threshold:.1});document.querySelectorAll(".reveal").forEach(t=>e.observe(t));const t=e=>{const t=e.closest(".skeleton-wrapper");t&&t.classList.add("loaded")};document.querySelectorAll(".skeleton-wrapper img").forEach(e=>{e.complete?t(e):(e.addEventListener("load",()=>t(e)),e.addEventListener("error",()=>{t(e)}))});const n=document.getElementById("verse-text");if(n){const e=n.innerText;n.innerText="",n.style.opacity="1";const t=new IntersectionObserver(a=>{a.forEach(a=>{a.isIntersecting&&(typeWriter(n,e,0),t.unobserve(a.target))})},{threshold:.5});t.observe(n)}});let lastKnownScrollPosition=0,ticking=!1;window.addEventListener("scroll",()=>{lastKnownScrollPosition=window.scrollY||document.documentElement.scrollTop,ticking||(window.requestAnimationFrame(()=>{const e=document.documentElement.scrollHeight-document.documentElement.clientHeight,t=document.getElementById("scroll-progress");t&&(t.style.width=lastKnownScrollPosition/e*100+"%");const n=document.getElementById("navbar"),a=document.getElementById("audio-btn");lastKnownScrollPosition>.75*window.innerHeight?(n&&n.classList.remove("-translate-y-full"),a&&a.classList.remove("translate-y-24","opacity-0")):(n&&n.classList.add("-translate-y-full"),a&&a.classList.add("translate-y-24","opacity-0")),document.querySelectorAll(".parallax").forEach(e=>{const t=e.getAttribute("data-speed")||.5,n=(e.parentElement.getBoundingClientRect(),-lastKnownScrollPosition*t);e.style.transform=`translateY(${n}px)`}),ticking=!1}),ticking=!0)},{passive:!0});const date=new Date("Jan 24, 2026 16:00:00").getTime();function toggleGuestCount(e){const t=document.getElementById("guest-count-container");"accept"===e.value?t.classList.remove("hidden"):t.classList.add("hidden")}setInterval(()=>{const e=(new Date).getTime(),t=Math.floor((date-e)/864e5),n=Math.floor((date-e)%864e5/36e5),a=Math.floor((date-e)%36e5/6e4),s=Math.floor((date-e)%6e4/1e3),o="glass w-20 h-24 md:w-28 md:h-32 rounded-2xl flex flex-col items-center justify-center border border-pink-200 dark:border-purple-500 shadow-md backdrop-blur-sm transform hover:scale-105 transition-transform duration-300 bg-white/40 dark:bg-black/20",i="font-handwriting text-3xl md:text-5xl font-bold text-pink-600 dark:text-pink-300 drop-shadow-sm leading-none mb-1",l="text-[10px] md:text-xs font-bold tracking-widest text-purple-900 dark:text-purple-200 uppercase opacity-70";document.getElementById("countdown").innerHTML=`\n        <div class="${o}">\n            <span class="${i}">${t}</span>\n            <span class="${l}">Hari</span>\n        </div>\n        <div class="${o}">\n            <span class="${i}">${n}</span>\n            <span class="${l}">Jam</span>\n        </div>\n        <div class="${o}">\n            <span class="${i}">${a}</span>\n            <span class="${l}">Menit</span>\n        </div>\n        <div class="${o}">\n            <span class="${i}">${s}</span>\n            <span class="${l}">Detik</span>\n        </div>\n    `},1e3);const defaultGuestBookData=[{name:"Putri & Dimas",message:"Congratulations lovebirds! ü¶Ñ Can't wait on the big day!",date:"2 mins ago",attendance:"accept",guestCount:2},{name:"Auntie Sarah",message:"So happy for you both. May your life be filled with magic. ‚ú®",date:"1 hour ago",attendance:"accept",guestCount:1},{name:"Budi Santoso",message:"Maaf tidak bisa hadir, tapi doa kami menyertai kalian. üê∏",date:"3 hours ago",attendance:"decline",guestCount:0}];let savedGuestBook=localStorage.getItem("weddingGuestBook"),guestBookData=savedGuestBook?JSON.parse(savedGuestBook):defaultGuestBookData;function renderGuestBook(){const e=document.getElementById("guest-book-list");e&&(e.innerHTML=guestBookData.map(e=>{const t="accept"===e.attendance&&e.guestCount?`<span class="font-normal text-xs text-purple-600 dark:text-purple-300 ml-1">- ${e.guestCount} ${e.guestCount>1?"People":"Person"}</span>`:"";return`\n        <div class="p-4 rounded-xl bg-purple-50 dark:bg-white/5 border border-purple-100 dark:border-white/10 animate-sparkle-fade">\n            <div class="flex justify-between items-start mb-2">\n                <div>\n                    <h4 class="font-bold text-sm text-purple-900 dark:text-purple-200">\n                        ${e.name}\n                        ${t}\n                    </h4>\n                    <span class="text-[10px] text-gray-500 uppercase tracking-widest">${e.date}</span>\n                </div>\n                <div class="text-xl" title="${"accept"===e.attendance?"Attending":"Not Attending"}">\n                    ${"accept"===e.attendance?"ü¶Ñ":"üê∏"}\n                </div>\n            </div>\n            <p class="text-sm text-gray-700 dark:text-gray-300 italic">"${e.message}"</p>\n        </div>\n    `}).join(""))}function submitRSVP(e){e.preventDefault();const t=e.target.querySelector('button[type="submit"]'),n=e.target,a=n.querySelector('input[placeholder*="Prince"]').value,s=n.querySelector('input[placeholder*="Charming"]').value,o=n.querySelector('input[name="attendance"]:checked').value,i=n.querySelector('textarea[name="message"]').value;let l=0;if("accept"===o){const e=n.querySelector('input[name="guest_count"]:checked');e?(l=parseInt(e.value)||0,"5+"===e.value&&(l=5)):l=1}t.disabled=!0,t.innerHTML='<span class="material-symbols-outlined animate-spin">refresh</span> Sending...',t.classList.add("opacity-80","cursor-not-allowed"),setTimeout(()=>{playChime("high"),createConfetti(window.innerWidth/2,window.innerHeight/2,50),i&&(guestBookData.unshift({name:`${a} ${s}`,message:i,date:"Just now",attendance:o,guestCount:l}),localStorage.setItem("weddingGuestBook",JSON.stringify(guestBookData)),renderGuestBook());const t=e.target.closest(".glass");t.style.transition="opacity 0.5s ease-out, transform 0.5s ease-out",t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>{t.innerHTML='\n                <div class="text-center py-12 flex flex-col items-center">\n                    <div class="text-6xl mb-4 animate-bounce">üíå</div>\n                    <h3 class="text-4xl font-handwriting text-purple-800 dark:text-white mb-2">Message Sent!</h3>\n                    <p class="opacity-80 max-w-sm mx-auto mb-6">Your response has been delivered to the stars. Thank you for being part of our fairytale.</p>\n                    <div class="bg-purple-100 dark:bg-purple-900/50 px-4 py-2 rounded-lg text-xs font-bold text-purple-700 dark:text-purple-300 mb-6">\n                        See your wish below! üëá\n                    </div>\n                    <button onclick="location.reload()" class="text-pink-500 font-bold hover:underline text-sm uppercase tracking-widest">\n                        Send another response\n                    </button>\n                </div>\n            ',t.style.opacity="1",t.style.transform="translateY(0)";const e=document.getElementById("guest-book-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},500)},1500)}async function initMap(){const{Map:e}=await google.maps.importLibrary("maps"),{AdvancedMarkerElement:t,PinElement:n}=await google.maps.importLibrary("marker"),a={lat:-7.7956,lng:110.3695};new t({map:new e(document.getElementById("map"),{center:a,zoom:12,mapId:"DEMO_MAP_ID",disableDefaultUI:!0}),position:a,content:new n({background:"#d8b4fe",borderColor:"#fff",glyphColor:"#fff"}).element})}